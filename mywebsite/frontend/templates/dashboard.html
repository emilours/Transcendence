{% load static %}
<section class="d-flex align-items-center justify-content-center mt-5">
	<div class="container mb-5">
		<h1 class="mb-3 card-title font-balsamiq text-center text-secondary-emphasis">{{ user_profile.display_name }}'s dashboard</h1>
		<div class="row justify-content-center g-3">
			<!-- History -->
			<div class="col-12 col-lg-6 col-xxl-4">
				<div class="card shadow rounded-2">
					<div class="card-header text-center bg-primary font-balsamiq text-secondary-emphasis rounded-top-2 pt-3">
						<h2 class="fs-4">Match History</h2>
					</div>
					<div class="card-body p-3">
						<table class="table table-striped table-hover dashboard-table">
							<thead>
								<tr class="font-balsamiq">
									<th class="text-secondary-emphasis">Result</th>
									<th class="text-secondary-emphasis">Date</th>
									<th class="text-secondary-emphasis">Game</th>
								</tr>
							</thead>
							<tbody id="dashboard-body">
								{% if dashboard_data %}
									{% for entry in dashboard_data %}
										{% if forloop.counter <= 5 %}
											<tr>
												<td class="text-secondary-emphasis">
													{% if entry.match.game.name == "Invaders" %}
														{{ entry.score }}
													{% elif entry.match.game.name == "Pong" %}
														{% if entry.is_winner %}
															<span class="text-success">Won</span>
															{% else %}
															<span class="text-danger">Lost</span>
														{% endif %}
													{% endif %}
												</td>
												<td class="text-secondary-emphasis">{{ entry.match.date|date:"Y-m-d" }}</td>
												<td class="text-secondary-emphasis">{{ entry.match.game.name }}</td>
											</tr>
										{% endif %}
									{% endfor %}
								{% else %}
									<tr>
										<td colspan="3" class="text-center text-secondary-emphasis">No games</td>
									</tr>
								{% endif %}
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<!-- Pong stats -->
			<div class="col-12 col-lg-6 col-xxl-4">
				<div class="card shadow rounded-2">
					<div class="card-header text-center bg-primary font-balsamiq text-secondary-emphasis rounded-top-2 pt-3">
						<h2 class="fs-4">Pong Stats</h2>
					</div>
					<div class="card-body p-3">
						<table class="table table-striped table-hover dashboard-table">
							<thead>
								<tr class="font-balsamiq text-center">
									<th class="text-secondary-emphasis text-center">Matches</th>
									<th class="text-secondary-emphasis text-center">Won/Lost</th>
									<th class="text-secondary-emphasis text-center">Max Score</th>
								</tr>
							</thead>
							<tbody id="dashboard-body">
								{% if pong_stats %}
									<tr>
										<td class="text-secondary-emphasis text-center">{{ pong_stats.total_matches }}</td>
										<td class="text-secondary-emphasis text-center">{{ pong_stats.victories }} / {{ pong_stats.defeats }}</td>
										<td class="text-secondary-emphasis text-center">{{ pong_stats.max_score }}</td>
									</tr>
								{% else %}
									<tr>
										<td colspan="4" class="text-center text-secondary-emphasis">No games</td>
									</tr>
								{% endif %}
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<!-- Invaders Stats -->
			<div class="col-12 col-lg-6 col-xxl-4">
				<div class="card shadow rounded-2">
					<div class="card-header text-center bg-primary font-balsamiq text-secondary-emphasis rounded-top-2 pt-3">
						<h2 class="fs-4">Invaders Stats</h2>
					</div>
					<div class="card-body p-3">
						<table class="table table-striped table-hover dashboard-table">
							<thead>
								<tr class="font-balsamiq text-center">
									<th class="text-secondary-emphasis text-center">Matches</th>
									<th class="text-secondary-emphasis text-center">Average</th>
									<th class="text-secondary-emphasis text-center">Max Score</th>
								</tr>
							</thead>
							<tbody id="dashboard-body">
								{% if invaders_stats %}
									<tr>
										<td class="text-secondary-emphasis text-center">{{ invaders_stats.total_matches }}</td>
										<td class="text-secondary-emphasis text-center">
											{% if invaders_stats.average %}
												{{ invaders_stats.average|floatformat:0 }}
											{% else %}
												No games
											{% endif %}
										</td>
										<td class="text-secondary-emphasis text-center">{{ invaders_stats.max_score }}</td>
									</tr>
								{% else %}
									<tr>
										<td colspan="3" class="text-center text-secondary-emphasis">No games</td>
									</tr>
								{% endif %}
							</tbody>
						</table>
					</div>
				</div>
			</div>

		</div>
	</div>
</section>
